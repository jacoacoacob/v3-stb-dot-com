{"mappings":"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","sources":["src/scripts/main.ts","src/scripts/qs.ts","src/scripts/setup-mobile-menu.ts","src/scripts/use-event.ts","src/scripts/use-trap-focus.ts","src/scripts/setup-toggle-dark-mode.ts"],"sourcesContent":["import { qs } from \"./qs\";\nimport { setupMobileMenu } from \"./setup-mobile-menu\";\n// import { setupBreadcrumbs } from \"./setup-breadcrumbs\";\nimport { setupToggleDarkMode } from \"./setup-toggle-dark-mode\";\n\nconst navbar = qs(\"#navbar\")!;\n\n// setupBreadcrumbs();\nconst cleanupMobileMenuListeners = setupMobileMenu(navbar);\nconst cleanupToggleDarkmodeListeners = setupToggleDarkMode();\n\nwindow.addEventListener(\"beforeunload\", () => {\n  cleanupMobileMenuListeners()\n  cleanupToggleDarkmodeListeners();\n});\n","\nfunction qs(selector: string, element?: Element): HTMLElement | null {\n  return element ? element.querySelector(selector) : document.querySelector(selector);\n}\n\nfunction qsAll(selector: string, element?: Element): NodeListOf<HTMLElement> {\n  return element ? element.querySelectorAll(selector) : document.querySelectorAll(selector);\n}\n\nexport { qs, qsAll };\n","import { qs } from \"./qs\";\nimport { useEvent } from \"./use-event\";\nimport { useTrapFocus } from \"./use-trap-focus\";\n\nfunction setupMobileMenu(navbar: HTMLElement) {\n  const btnMenuOpen = qs(\"#mobile-menu-open\");\n  const btnMenuClose = qs(\"#mobile-menu-close\");\n\n  const [trapFocus, releaseFocus] = useTrapFocus(navbar, \"[data-mobile-menu-focusable]\");\n\n  const menuMachine = {\n    state: \"closed\",\n    toggleState() {\n      this.state = this.state === \"closed\" ? \"open\" : \"closed\";\n      this.tick();\n    },\n    setState(newState: \"open\" | \"closed\") {\n      this.state = newState;\n      this.tick();\n    },\n    actions: {\n      closed() {\n        document.documentElement.classList.remove(\n          \"mobile-menu-open\"\n        );\n        releaseFocus();\n      },\n      open() {\n        document.documentElement.classList.add(\n          \"mobile-menu-open\"\n        );\n        btnMenuClose.focus();\n        trapFocus();\n      },\n    },\n    tick() {\n      this.actions[this.state as \"closed\" | \"open\"]()\n    },\n  };\n\n  const unlisteners: (() => void)[] = [] \n\n  const [listenWindowFocus, unlistenWindowFocus] = useEvent(\n    window,\n    \"focus\",\n    closeMenu\n  );\n\n  listenWindowFocus()\n\n  unlisteners.push(unlistenWindowFocus);\n\n  function closeMenu() {\n    if (localStorage.locationHref !== location.href) {\n      menuMachine.state = \"closed\";\n      menuMachine.tick();\n    }\n    localStorage.locationHref = location.href;\n  }\n\n  closeMenu();\n\n  ([[btnMenuOpen, \"open\"], [btnMenuClose, \"closed\"]] as [HTMLElement, \"open\" | \"closed\"][]).forEach(\n    ([element, state]) => {\n      const [listen, unlisten] = useEvent(element, \"click\", () => {\n        menuMachine.setState(state);\n      });\n      listen();\n      unlisteners.push(unlisten);\n    })\n\n  function cleanupListeners() {\n    unlisteners.forEach(unlisten => unlisten());\n  }\n\n  return cleanupListeners;\n}\n\nexport { setupMobileMenu };\n","\nfunction useEvent<EventType extends Event>(elem: Element | Window | Document, type: string, listener: (event: EventType) => void) {\n  function setup() {\n    elem.addEventListener(type, listener as EventListener);\n  }\n\n  function teardown() {\n    elem.removeEventListener(type, listener as EventListener);\n  }\n\n  return [setup, teardown]\n}\n\nfunction useKeyboardEvent(element: Element, type: string, listener: (event: KeyboardEvent) => void) {\n  return useEvent<KeyboardEvent>(element, type, listener);\n}\n\nexport { useEvent, useKeyboardEvent };\n","import { useKeyboardEvent } from \"./use-event\";\nimport { qsAll } from \"./qs\";\n\nfunction useTrapFocus(container: HTMLElement, selector: string) {\n  const focusableElements = qsAll(selector);\n\n  let focusCursor = 0;\n\n  function increment() {\n    focusCursor = focusCursor + 1 > focusableElements.length - 1 ? 0 : focusCursor + 1;\n  }\n\n  function decrement() {\n    focusCursor = focusCursor - 1 < 0 ? focusableElements.length - 1 : focusCursor - 1;\n  }\n\n  return useKeyboardEvent(container, \"keydown\", (event) => {\n    if (event.key === \"Tab\") {\n      event.shiftKey ? decrement() : increment();\n      focusableElements[focusCursor].focus();\n      event.preventDefault();\n    }\n  });\n}\n\nexport { useTrapFocus };\n","import { qsAll } from \"./qs\";\nimport { useEvent } from \"./use-event\";\n\nfunction setupToggleDarkMode() {\n\n  function getIsDarkMode() {\n    return localStorage.getItem(\"dark-mode\") === \"true\";\n  }\n\n  function setIsDarkMode(value: boolean) {\n    localStorage.setItem(\"dark-mode\", JSON.stringify(value));\n  }\n\n  function onToggleDarkMode() {\n    setIsDarkMode(!getIsDarkMode());\n    updateUI();\n  }\n\n  function updateUI() {\n    if (getIsDarkMode()) {\n      document.documentElement.classList.add(\"dark\");\n    } else {\n      document.documentElement.classList.remove(\"dark\");\n    }\n  }\n\n  updateUI();\n\n  const unlisteners: (() => void)[] = [];\n\n  qsAll(\"[data-toggle-dark-mode]\").forEach(element => {\n    const [listen, unlisten] = useEvent(element, \"click\", onToggleDarkMode);\n    listen();\n    unlisteners.push(unlisten);\n  });\n\n  function cleanupListeners() {\n    unlisteners.forEach(unlisten => unlisten());\n  }\n\n  return cleanupListeners;\n}\n\nexport { setupToggleDarkMode };\n"],"names":[],"version":3,"file":"main.js.map"}